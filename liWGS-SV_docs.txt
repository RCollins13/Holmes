liWGS-SV Documentation
Contact: Ryan Collins (rcollins@chgr.mgh.harvard.edu)
Update: August 2015

Execution command:
liWGS_SV.sh samples.list parameters_info.sh

##INPUT##
samples.list: three columns, tab delimited, col 1) sample ID, col 2) full path to sample bam, col 3) expected sex (M=XY, F=XX, O=other, U=unknown (will defer to predicted sex by sexcheck))
parameters_info.sh: shell script to export all parameters for pipeline run

##MODULE 1: QC##
Runs the following:
	Picard EstimateLibraryComplexity
	Picard CollectAlignmentSummaryMetrics
	Picard CollectInsertSizeMetrics
	Picard CollectWgsMetrics
	Samtools flagstat
	Bamtools stats
	Sex Check
	WGS Dosage Bias Check
Checks for nominal QC values, reports errors to ${OUTDIR}/${COHORT_ID}_WARNINGS.txt
Writes master QC table to ${OUTDIR}/QC/cohort/${COHORT_ID}.QC.metrics

##MODULE 2: PHYSICAL DEPTH ANALYSES##
Runs binCov to generate 1kb binned physical depth for each library
BGZips & tabix indexes each coverage file (for classifier)

##MODULE 3: PER-SAMPLE CLUSTERING##
Runs bamstat at min cluster size = 3 for each sample
Removes *pairs.txt and *pairs.sorted.txt to save space

##MODULE 4: PHYSICAL DEPTH CNV CALLING##
Runs cnMOPS on autosomes on all samples
Runs cnMOPS on allosomes on samples split by M/F. "Other" sex samples pooled with either M or F depending on ${other_assign}
Merges cnMOPS calls per sample
Runs Serkan's log2R DNAcopy large CNV caller. Allosomes not split by sex; maybe include this functionality in future updates

##MODULE 5: JOINT RECLUSTERING & CLASSIFICATION##
Runs classifier
Patches clusters
Reclassifies patched clusters
Applies final classification labels & sets coordinate reporting to be 1st or 3rd quartile of reads, respectively (to avoid overclustering/negative sizes)

